
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Strategic Practice 2 (SP2) &#8212; Exploring cell types in the brain</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Strategic practice 1 (SP1)" href="SP1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Exploring cell types in the brain</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Allen_Intro.html">
   Week 1: A data science safari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SP1.html">
   Strategic practice 1 (SP1)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Strategic Practice 2 (SP2)
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/SP2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FSP2.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/SP2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Strategic Practice 2 (SP2)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-and-background">
   Setup and Background:
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-bit-more-practice-with-pandas-filtering-and-slicing">
   A bit more practice with Pandas: filtering and slicing
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-and-fitting-distributions">
   Plotting and fitting distributions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-percentiles-from-scratch">
   Calculating percentiles from scratch
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-variance-from-scratch">
   Calculating variance from scratch
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Strategic Practice 2 (SP2)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Strategic Practice 2 (SP2)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-and-background">
   Setup and Background:
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-bit-more-practice-with-pandas-filtering-and-slicing">
   A bit more practice with Pandas: filtering and slicing
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-and-fitting-distributions">
   Plotting and fitting distributions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-percentiles-from-scratch">
   Calculating percentiles from scratch
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-variance-from-scratch">
   Calculating variance from scratch
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="strategic-practice-2-sp2">
<h1>Strategic Practice 2 (SP2)<a class="headerlink" href="#strategic-practice-2-sp2" title="Permalink to this headline">#</a></h1>
<p>Today we’ll work with the actual morphology data from the Allen Institute, as opposed to a toy dataset. Like last time, the goal here is ‘strategic practice’: understanding core statistical concepts and fundamental python idioms through drill-like problems. That said, you will probably find some of these a little bit harder than last week – there may be a missing step in some cases that you’ll need to think about.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="setup-and-background">
<h1>Setup and Background:<a class="headerlink" href="#setup-and-background" title="Permalink to this headline">#</a></h1>
<p>The block of code below will get set up everything you need to answer the practice questions. It imports the basic libraries which you’re probably starting to get familiar with, loads the Allen morphology data, and bundles it into a dataframe for you. Unless otherewise stated, the dataframe you’ll need to use on the questions is called ‘morphology.’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">allensdk.core.cell_types_cache</span> <span class="kn">import</span> <span class="n">CellTypesCache</span>

<span class="c1"># Get the data</span>
<span class="n">ctc</span> <span class="o">=</span> <span class="n">CellTypesCache</span><span class="p">(</span><span class="n">manifest_file</span><span class="o">=</span><span class="s1">&#39;cell_types/manifest.json&#39;</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ctc</span><span class="o">.</span><span class="n">get_all_features</span><span class="p">(</span><span class="n">require_reconstruction</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">cell_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ctc</span><span class="o">.</span><span class="n">get_cells</span><span class="p">(</span><span class="n">require_reconstruction</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Discard ephys data &amp; retain morphology and cell identifiers</span>
<span class="n">features_morpho</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;overall_depth&#39;</span><span class="p">,</span><span class="s1">&#39;number_bifurcations&#39;</span><span class="p">,</span><span class="s1">&#39;average_bifurcation_angle_local&#39;</span><span class="p">,</span> <span class="s1">&#39;average_diameter&#39;</span><span class="p">]]</span>
<span class="n">features_morpho</span><span class="p">[</span><span class="s1">&#39;specimen_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;specimen_id&#39;</span><span class="p">]</span>

<span class="c1"># Merge features and metadata</span>
<span class="n">morphology</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">features_morpho</span><span class="p">,</span>
              <span class="n">cell_metadata</span><span class="p">[[</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;structure_area_abbrev&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">]],</span> 
              <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;specimen_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

<span class="n">morphology</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>overall_depth</th>
      <th>number_bifurcations</th>
      <th>average_bifurcation_angle_local</th>
      <th>average_diameter</th>
      <th>specimen_id</th>
      <th>species</th>
      <th>structure_area_abbrev</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>529878215</th>
      <td>135.5200</td>
      <td>56</td>
      <td>72.604110</td>
      <td>0.527213</td>
      <td>529878215</td>
      <td>Homo Sapiens</td>
      <td>MTG</td>
    </tr>
    <tr>
      <th>548459652</th>
      <td>148.0957</td>
      <td>44</td>
      <td>68.499396</td>
      <td>0.614133</td>
      <td>548459652</td>
      <td>Homo Sapiens</td>
      <td>MFG</td>
    </tr>
    <tr>
      <th>479013100</th>
      <td>52.7875</td>
      <td>18</td>
      <td>77.679949</td>
      <td>0.488865</td>
      <td>479013100</td>
      <td>Mus musculus</td>
      <td>VISp</td>
    </tr>
    <tr>
      <th>567952169</th>
      <td>57.2006</td>
      <td>23</td>
      <td>73.926537</td>
      <td>0.216384</td>
      <td>567952169</td>
      <td>Mus musculus</td>
      <td>VISp</td>
    </tr>
    <tr>
      <th>569095789</th>
      <td>106.0998</td>
      <td>22</td>
      <td>89.985385</td>
      <td>0.289549</td>
      <td>569095789</td>
      <td>Homo Sapiens</td>
      <td>AnG</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="a-bit-more-practice-with-pandas-filtering-and-slicing">
<h1>A bit more practice with Pandas: filtering and slicing<a class="headerlink" href="#a-bit-more-practice-with-pandas-filtering-and-slicing" title="Permalink to this headline">#</a></h1>
<div class="seealso admonition">
<p class="admonition-title">Question 1</p>
<p>Create a dataframe that only has rows from ‘morphology’ with cells having more than 70 bifurcations (cataloged in num_bifurcations). What brain areas appear to be heavily represented in this set?</p>
</div>
<div class="seealso admonition">
<p class="admonition-title">Question 2</p>
<p>Create a dataframe called morpho_numeric_features that consists of the first three columns of morphology. Use the slice syntax discussed earlier to do this (i.e., use the colon(:) to specify a range; don’t explicitly name each column)</p>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plotting-and-fitting-distributions">
<h1>Plotting and fitting distributions<a class="headerlink" href="#plotting-and-fitting-distributions" title="Permalink to this headline">#</a></h1>
<div class="seealso admonition">
<p class="admonition-title">Question 3</p>
<p>Plot a scattermatrix of morpho_numeric_features, and inspect the univariate distributions of each variable (along the diagonal). Suppose one of these distributions is exponential, one is gaussian, and one is (quasi) uniform. Which is which? (Use each distribution only once, and pick the best, even if you feel the description isn’t necessarily perfect). For the variable you designated as uniform(ish), what does its uniformity tell you about cells in the dataset?</p>
</div>
<div class="seealso admonition">
<p class="admonition-title">Question 4</p>
<p>Extract the column from the morpho_numeric_features that you think is gaussian. Compute a normalized histogram of this feature, such that the y axis of you histogram indicates relative frequencies, not total counts. To do this, you’ll want to use matplotlib’s plt.hist() method, which takes a parameter ‘density=True’.</p>
</div>
<p>Recall that we can use the scipy module norm() to both generate normally distributed data, and to fit data to a normal distribution (and also do a lot of other things). By way of reminder, the block of code below shows you some of this basic functionality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># Create an array of a thousand points sampled from a normal distribution w/ zero mean and unit variance.</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">variance</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fake_data</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">variance</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Plot a histogram of the fake data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">fake_data</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>

<span class="c1"># Use the .fit() function to fit a normal distribution to the data, and estimate the mean and variance. </span>
<span class="c1"># Note: We of course KNOW that our points come from a normal distribution w/ zero mean and unit variance; </span>
<span class="c1"># we&#39;re just illustrating usage of the function. </span>
<span class="p">(</span><span class="n">mean_estimate</span><span class="p">,</span> <span class="n">var_estimate</span><span class="p">)</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fake_data</span><span class="p">)</span>

<span class="c1"># Get the x range of our histogram, and create an array w/ 100 evenly spaced points over this range. </span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Create a plot of a Gaussian PDF, using our estimated mean and variance</span>
<span class="n">normal_fit</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean_estimate</span><span class="p">,</span> <span class="n">var_estimate</span><span class="p">)</span>

<span class="c1"># Plot the fit on top of our histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">normal_fit</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/SP2_10_0.png" src="_images/SP2_10_0.png" />
</div>
</div>
<div class="seealso admonition">
<p class="admonition-title">Question 5</p>
<p>Use the scipy function ‘norm’ to compute a fit to the column from morpho_numeric_features that you think is normally distributed. What are the mean and standard deviation from the fit procedure, and how do these compare to the mean and standard deviation you calculate directly from the data, using Pandas’ .mean() and .std() functions?</p>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculating-percentiles-from-scratch">
<h1>Calculating percentiles from scratch<a class="headerlink" href="#calculating-percentiles-from-scratch" title="Permalink to this headline">#</a></h1>
<div class="seealso admonition">
<p class="admonition-title">Question 6</p>
<p>What is a percentile? Give as clear and precise a definition as you can, and describe a step-by-step procedure for starting with an array of numbers, and returning a value that corresponds to the n-th percentile (where n is an arbitrary number between 0 and 100)</p>
</div>
<p>Let’s put our numpy hat on for these next few questions. We’ll work with the ‘depth’ data from the morphology dataframe, which tells us the depth (in microns) of the soma of a given cell, relative to the surface of the brain</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">depth</span> <span class="o">=</span> <span class="n">morpho_numeric_features</span><span class="p">[</span><span class="s1">&#39;overall_depth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">morpho_numeric_features</span><span class="p">[</span><span class="s1">&#39;overall_depth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;morpho_numeric_features&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="seealso admonition">
<p class="admonition-title">Question 7</p>
<p>Calculate the 90th percentile of depth, without using pandas. You will find the functions np.sort(), np.shape() and np.floor() handy.</p>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculating-variance-from-scratch">
<h1>Calculating variance from scratch<a class="headerlink" href="#calculating-variance-from-scratch" title="Permalink to this headline">#</a></h1>
<p>Calculating the variance of a feature using Pandas is very straightforward. For example, if I was interested in how variable neurons were in their numer of bifurcations, that’s given by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morpho_numeric_features</span><span class="p">[</span><span class="s1">&#39;number_bifurcations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>227.4025596087221
</pre></div>
</div>
</div>
</div>
<p>Recall that variance is the average of the data’s <em>squared</em> deviations from mean, meaning that it’s not on the same original scale as the data. For a more apples to apples comparison, it’s customary to take the square root of the variance, or the standard deviation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morpho_numeric_features</span><span class="p">[</span><span class="s1">&#39;number_bifurcations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.079872665534086
</pre></div>
</div>
</div>
</div>
<p>You’ll get exactly the same result if you use Pandas std() function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">morpho_numeric_features</span><span class="p">[</span><span class="s1">&#39;number_bifurcations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.079872665534086
</pre></div>
</div>
</div>
</div>
<div class="seealso admonition">
<p class="admonition-title">Question 8</p>
<p>Calculate the variance of this list of numbers by hand: [1, 0, 3, 4]. In a markdown cell, write out a full expression showing the calculation. For example: variance = (1 x 2^2) + (3-6)^3 + …. (Clearly this expression is incorrect – I’m just giving a generic illustration of what I’m looking for).</p>
</div>
<div class="seealso admonition">
<p class="admonition-title">Question 9</p>
<p>Pretend the var() function in Pandas didn’t exist. Calculate the variance in number of bifurcations using only the numpy expression np.mean() and arithmetic expressions +, -, ** . The first thing you’ll want to do is get the number_bifurcations column and turn it into an array, which is done for you below. One helpful thing to note is that numpy is smart about the ‘broadcasting’ of array in simple expressions. For example, if I had an array like [1,0,2,4,10], and I tried to subtract just the single value 1 from it, numpy would know that I’m really trying to subtract 1 from each element in the array.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_bif</span> <span class="o">=</span> <span class="n">morpho_numeric_features</span><span class="p">[</span><span class="s1">&#39;number_bifurcations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="SP1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Strategic practice 1 (SP1)</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jason Castro<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>